{% extends "admin/base.html" %}

{% block content %}
    <div class="flex justify-between items-center mb-6">
        <div>
            <h2 class="text-2xl font-bold">Manage Sections</h2>
            <p class="text-zinc-500">Lesson: <span class="font-semibold">{{ lesson.title }}</span> ({{ lesson.id }})</p>
        </div>
        <a href="{{ url_for('admin.learning') }}" class="text-zinc-500 hover:text-zinc-700">Back to Lessons</a>
    </div>

    <!-- Create Section Form -->
    <div class="bg-white p-6 rounded-lg shadow border border-zinc-200 mb-8">
        <h3 class="text-lg font-semibold mb-4">Add New Section</h3>
        <form action="{{ url_for('admin.create_section', lesson_id=lesson.id) }}" method="POST" class="space-y-4">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="md:col-span-1">
                    <label class="block text-sm font-medium text-zinc-700 mb-1">Title</label>
                    <input type="text" name="title" class="w-full p-2 border border-zinc-300 rounded focus:ring-2 focus:ring-zinc-500 focus:border-zinc-500 outline-none" required>
                </div>
                <div class="md:col-span-1">
                    <label class="block text-sm font-medium text-zinc-700 mb-1">Content</label>
                    <input type="text" name="content" class="w-full p-2 border border-zinc-300 rounded focus:ring-2 focus:ring-zinc-500 focus:border-zinc-500 outline-none" placeholder="Short description or text">
                </div>
                <div class="md:col-span-1">
                    <label class="block text-sm font-medium text-zinc-700 mb-1">Quiz ID (Optional)</label>
                    <input type="text" name="quiz_id" class="w-full p-2 border border-zinc-300 rounded focus:ring-2 focus:ring-zinc-500 focus:border-zinc-500 outline-none" placeholder="e.g. q1">
                </div>
            </div>
            <button type="submit" class="bg-zinc-900 text-white px-4 py-2 rounded hover:bg-zinc-800 transition text-sm font-medium">Add Section</button>
        </form>
    </div>

    <!-- Sections List -->
    <div class="bg-white shadow rounded-lg overflow-hidden border border-zinc-200">
        <table class="min-w-full divide-y divide-zinc-200">
            <thead class="bg-zinc-50">
                <tr>
                    <th class="px-6 py-3 text-left text-xs font-medium text-zinc-500 uppercase tracking-wider">ID</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-zinc-500 uppercase tracking-wider">Title / Content</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-zinc-500 uppercase tracking-wider">Quiz ID</th>
                    <th class="px-6 py-3 text-right text-xs font-medium text-zinc-500 uppercase tracking-wider">Actions</th>
                </tr>
            </thead>
            <tbody class="bg-white divide-y divide-zinc-200">
                {% for section in lesson.sections %}
                <tr>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-zinc-500">{{ section.id }}</td>
                    <td class="px-6 py-4 text-sm text-zinc-900">
                        <form action="{{ url_for('admin.edit_section', section_id=section.id) }}" method="POST" class="space-y-2">
                             <input type="text" name="title" value="{{ section.title }}" class="w-full p-1 border border-zinc-200 rounded text-sm font-medium focus:border-zinc-500 outline-none">
                             <textarea name="content" rows="2" class="w-full p-1 border border-zinc-200 rounded text-sm text-zinc-600 focus:border-zinc-500 outline-none">{{ section.content }}</textarea>
                    </td>
                    <td class="px-6 py-4 text-sm text-zinc-500">
                             <input type="text" name="quiz_id" value="{{ section.quiz_id if section.quiz_id else '' }}" class="w-24 p-1 border border-zinc-200 rounded text-sm focus:border-zinc-500 outline-none" placeholder="-">
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium align-top pt-6">
                            <button type="submit" class="text-zinc-600 hover:text-zinc-900 mr-2">Update</button>
                        </form>
                        <form action="{{ url_for('admin.delete_section', section_id=section.id) }}" method="POST" onsubmit="return confirm('Delete this section?');" class="inline">
                            <button type="submit" class="text-red-600 hover:text-red-900">Delete</button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}
